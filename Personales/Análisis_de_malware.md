# Malware Analysis 

https://tryhackme.com/room/malware-sandbox-aoc2025-SD1zn4fZQt

El análisis de malware es el proceso en el cual se examina un archivo malicioso para:
- Entender su funcionamiento
- Entender sus métodos de operación/ejecución
- Idear métodos para defenderse ante este
- Saber si la ejecución del mismo deja “rastros” en el dispositivo

El análisis se debe ejecutar en entornos controlados y aislados(máquinas virtuales, sandboxes,...) ya que sigue siendo un virus que se está ejecutando y puede afectar a las máquinas principales
# Tipos de análisis de malware

## Estático

El análisis estático es un primer vistazo de cómo podría funcionar el malware y de cómo se podría identificar una vez en funcionamiento. Del análisis estático se puede sacar:
- Checksums: Son secuencias alfanuméricas que son únicas, como hash , sha-256 por ejemplo. Si se buscan en internet, se puede saber si se ha identificado antes
- Strings: Los strings son características legibles en el ejecutable. Por ejemplo, los strings pueden ser IPs, urls, comandos, contraseñas, usuarios,...
- Imports: Los imports son listas de librerías y/o funciones de las que la app depende.Por ejemplo, en lugar de construir algo desde 0, las apps usarán funciones del sistema y librerías para interactuar con el sistema operativo. En el análisis de malware, en windows, permiten saber cómo el malware interactúa con el sistema
- Recursos: Contiene datos como el propio icono de acceso directo del malware por ejemplo. Es útil para revisarlo ya que los malware, uno de sus métodos de instalación consiste en “disfrazarse” en una app legitima(Como un word)
Una app normalmente usada para este tipo de análisis es PeStudio.


### Otras apps que se pueden usar para el análisis estático

#### Descompiladores
- IDA Pro
- Ghidra
- Radare2
#### Análisis de binarios
- Hopper
- CFF Explorer
#### Análisis de strings
- HxD
#### Comparación de muestras
- YARA
- Binwalk
#### Hash/Integridad
- MD5sum o sha256sum
- Virustotal

## Dinámico

El análisis dinámico es el análisis durante y tras su ejecución del malware. Algunas herramientas útiles son:

### Regshot

Siendo una herramienta muy útil a la hora de analizar malware en windows, desde el punto de vista de análisis dinámico. El malware intenta normalmente ,bajo casi todos los medios posibles, establecer persistencia en el sistema operativo, por ejemplo “anclandose” a un proceso de arranque.

El proceso de regshot consiste en tomar una “imagen”/registro del sistema antes y después de la ejecución del malware y compara los “resultados” 

### Procmon
Process Monitor
Aplicación que se usa para monitorear e investigar cómo los procesos interactúan con el sistema operativo.
Tras usarlo por un periodo de tiempo en el que monitorea dichos procesos, se verá mucha información interna siendo la más antigua la que esté abajo. También se pueden aplicar filtros en base a lo que se busque. El filtro en este programa de windows, se debe aplicar:
- Insertar el nombre del proceso al filtro
- Seleccionar la condición(En la app suele ser en inglés, tiene varios , como: is, contains, is not, begins with,...)
- Nombre del proceso que se quiere buscar
Una vez aplicado, saldrá el o los resultados que cumplan con dichas características en el filtro para poder llevar a cabo un análisis más profundo
